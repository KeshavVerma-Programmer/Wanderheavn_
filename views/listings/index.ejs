<% layout("/layouts/boilerplate") %> 

<style>
  #filter-container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 1rem;
    margin-top: 1rem;
  }

  #filters {
    display: flex;
    align-items: center;
    gap: 3.5rem;
  }

  .filter {
    text-align: center;
    cursor: pointer;
    font-size: 12px;
    opacity: 0.7;
  }

  .filter:hover {
    opacity: 1;
  }

  .filter i {
    font-size: 18px; /* Icon size */
  }

  .price-range {
    flex-grow: 1;
    max-width: 40%;
    text-align: center;
  }

  .price-range label {
    font-size: 12px;
    font-weight: bold;
    display: block;
  }

  .price-range input[type="range"] {
    width: 100%;
    appearance: none;
    background: transparent;
  }

  .price-range input[type="range"]::-webkit-slider-runnable-track {
    height: 4px;
    background: rgb(185, 184, 181);
    border-radius: 4px;
  }

  .price-range input[type="range"]::-webkit-slider-thumb {
    appearance: none;
    width: 12px;
    height: 12px;
    background: #ff5733;
    border-radius: 50%;
    cursor: pointer;
    margin-top: -4px;
  }

  .price-range div {
    font-size: 10px;
    font-weight: bold;
    color: #333;
  }
</style>

<!-- Filters and Price Range in One Row -->
<div id="filter-container">
  <div id="filters">
    <% const filters = [
      { icon: "fa-building", label: "Apartment" },
      { icon: "fa-house-chimney", label: "Villa" },
      { icon: "fa-house", label: "Cabin" },
      { icon: "fa-home", label: "Bungalow" },
      { icon: "fa-umbrella-beach", label: "Resort" },
      { icon: "fa-campground", label: "Camping" }
    ]; %>

    <% filters.forEach(filter => { %>
      <div class="filter">
        <i class="fa-solid <%= filter.icon %>"></i>
        <p><%= filter.label %></p>
      </div>
    <% }) %>
  </div>

  <!-- Price Range Filter -->
  <div class="price-range">
    <input type="range" class="form-range" id="priceSlider" min="500" max="2500" step="500" value="500" oninput="updatePriceValue(this.value)">
    <div class="d-flex justify-content-between">
      <span>&#8377;500</span>
      <span>&#8377;1000</span>
      <span>&#8377;1500</span>
      <span>&#8377;2000</span>
      <span>&#8377;2500</span>
    </div>
  </div>
</div>

<!-- Listings Section -->
<div class="row row-cols-lg-3 row-cols-md-2 row-cols-sm-1 mt-3">
  <% if (allListings.length === 0) { %>
    <p class="text-center">No listings found.</p>
  <% } %>
  <% for(let listing of allListings) { %>
    <div class="card col listing-card">
      <a href="/listings/<%= listing._id %>" class="listing-link">
        <img src="<%= listing.images.length ? listing.images[0].url : '/images/default.jpg' %>" 
        class="card-img-top" 
        alt="listing_image" 
        style="height: 20rem;">
        <div class="card-img-overlay"></div>
        <div class="card-body">
          <p class="card-text"><b><%= listing.title %></b><br>
            &#8377;<%= listing.price.toLocaleString("en-IN") %> /night
          </p>
        </div>
      </a>
    </div>
  <% } %>
</div> 

<!-- Price Range Script -->
<script>
  function updatePriceValue(value) {
    document.getElementById("selectedPrice").innerText = value;
  }
</script>
